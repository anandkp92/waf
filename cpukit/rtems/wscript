def build(ctx):
	source = []

	source_mp = [
		"src/eventmp.c",
		"src/mp.c",
		"src/msgmp.c",
		"src/partmp.c",
		"src/regionmp.c",
		"src/semmp.c",
		"src/signalmp.c",
		"src/taskmp.c"
	]
	ctx.cpu.mp(
		source_mp,
		features="src_include"
	)


	source += [
		"src/barrier.c",
		"src/barriercreate.c",
		"src/barrierdata.c",
		"src/barrierdelete.c",
		"src/barrierident.c",
		"src/barrierrelease.c",
		"src/barriertranslatereturncode.c",
		"src/barrierwait.c",
		"src/clockget.c",
		"src/clockgetsecondssinceepoch.c",
		"src/clockgettickspersecond.c",
#		"src/clockgettickssinceboot.c",
		"src/clockgettod.c",
		"src/clockgettodtimeval.c",
		"src/clockgetuptime.c",
		"src/clockset.c",
		"src/clocksetnsecshandler.c",
		"src/clocktick.c",
		"src/clocktodtoseconds.c",
		"src/clocktodvalidate.c",
		"src/dpmem.c",
		"src/dpmemcreate.c",
		"src/dpmemdata.c",
		"src/dpmemdelete.c",
		"src/dpmemexternal2internal.c",
		"src/dpmemident.c",
		"src/dpmeminternal2external.c",
		"src/event.c",
		"src/eventdata.c",
		"src/eventreceive.c",
		"src/eventseize.c",
		"src/eventsend.c",
		"src/eventsurrender.c",
		"src/eventtimeout.c",
		"src/intrbody.c",
		"src/intrcatch.c",
		"src/msg.c",
		"src/msgdata.c",
#		"src/msgqallocate.c",
		"src/msgqbroadcast.c",
		"src/msgqcreate.c",
		"src/msgqdelete.c",
		"src/msgqflush.c",
		"src/msgqgetnumberpending.c",
		"src/msgqident.c",
		"src/msgqreceive.c",
		"src/msgqsend.c",
		"src/msgqtranslatereturncode.c",
		"src/msgqurgent.c",
		"src/part.c",
		"src/partcreate.c",
		"src/partdata.c",
		"src/partdelete.c",
		"src/partgetbuffer.c",
		"src/partident.c",
		"src/partreturnbuffer.c",
		"src/ratemon.c",
		"src/ratemoncancel.c",
		"src/ratemoncreate.c",
		"src/ratemondata.c",
		"src/ratemondelete.c",
		"src/ratemongetstatistics.c",
		"src/ratemongetstatus.c",
		"src/ratemonident.c",
		"src/ratemonperiod.c",
		"src/ratemonreportstatistics.c",
		"src/ratemonresetall.c",
		"src/ratemonresetstatistics.c",
		"src/ratemontimeout.c",
		"src/region.c",
		"src/regioncreate.c",
		"src/regiondata.c",
		"src/regiondelete.c",
		"src/regionextend.c",
		"src/regiongetfreeinfo.c",
		"src/regiongetinfo.c",
		"src/regiongetsegment.c",
		"src/regiongetsegmentsize.c",
		"src/regionident.c",
		"src/regionprocessqueue.c",
		"src/regionresizesegment.c",
		"src/regionreturnsegment.c",
		"src/rtemsbuildid.c",
		"src/rtemsbuildname.c",
		"src/rtemsobjectapimaximumclass.c",
		"src/rtemsobjectapiminimumclass.c",
		"src/rtemsobjectgetapiclassname.c",
		"src/rtemsobjectgetapiname.c",
		"src/rtemsobjectgetclassicname.c",
		"src/rtemsobjectgetclassinfo.c",
		"src/rtemsobjectgetname.c",
		"src/rtemsobjectidapimaximum.c",
		"src/rtemsobjectidapiminimum.c",
		"src/rtemsobjectidgetapi.c",
		"src/rtemsobjectidgetclass.c",
		"src/rtemsobjectidgetindex.c",
		"src/rtemsobjectidgetnode.c",
		"src/rtemsobjectsetname.c",
		"src/rtemstimer.c",
		"src/rtemstimerdata.c",
		"src/sem.c",
		"src/semcreate.c",
		"src/semdata.c",
		"src/semdelete.c",
		"src/semflush.c",
		"src/semident.c",
		"src/semobtain.c",
		"src/semrelease.c",
		"src/semtranslatereturncode.c",
		"src/systemeventsend.c",
		"src/signal.c",
		"src/signalcatch.c",
		"src/signalsend.c",
		"src/taskcreate.c",
		"src/taskdata.c",
		"src/taskdelete.c",
		"src/taskgetnote.c",
		"src/taskident.c",
		"src/taskinitusers.c",
		"src/taskissuspended.c",
		"src/taskmode.c",
		"src/taskrestart.c",
		"src/taskresume.c",
		"src/tasks.c",
		"src/taskself.c",
		"src/tasksetnote.c",
		"src/tasksetpriority.c",
		"src/taskstart.c",
		"src/tasksuspend.c",
		"src/taskvariableadd.c",
		"src/taskvariabledelete.c",
		"src/taskvariableget.c",
		"src/taskvariable_invoke_dtor.c",
		"src/taskwakeafter.c",
		"src/taskwakewhen.c",
		"src/timercancel.c",
		"src/timercreate.c",
		"src/timerdelete.c",
		"src/timerfireafter.c",
		"src/timerfirewhen.c",
		"src/timergetinfo.c",
		"src/timerident.c",
		"src/timerreset.c",
		"src/timerserver.c",
		"src/timerserverfireafter.c",
		"src/timerserverfirewhen.c",
		"src/workspace.c",
		"src/status.c",
		"src/systemeventreceive.c",
		"src/workspacegreedy.c",
		"src/clockgetuptimetimeval.c",
		"src/clockgetuptimeseconds.c",
		"src/modes.c",
		"src/statustext.c",
		"src/clockgetuptimenanoseconds.c",
		"src/getprocessorcount.c"
	]

	ctx.cpu.source(
		source,
		alias="rtems",
		features="src_include"
	)
